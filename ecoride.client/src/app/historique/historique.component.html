
<h2 style="text-align: center; margin-top: 2rem;">Historique de vos covoiturages</h2>

<form class="centeredForm" *ngIf="covoiturages.length > 0; else aucunResultat">
  <div *ngFor="let covoiturage of covoiturages" style="margin-bottom: 2rem; border-bottom: 1px solid #ddd; padding-bottom: 1.5rem;">

    <label>Date de départ :</label>
    <input type="text" [value]="covoiturage.dateDepart | date:'fullDate'" disabled>

    <label>Heure de départ :</label>
    <input type="text" [value]="covoiturage.heureDepart" disabled>

    <label>Lieu de départ :</label>
    <input type="text" [value]="covoiturage.lieuDepart" disabled>

    <label>Date d’arrivée :</label>
    <input type="text" [value]="covoiturage.dateArrivee" disabled>

    <label>Heure d’arrivée :</label>
    <input type="text" [value]="covoiturage.heureArrivee" disabled>

    <label>Lieu d’arrivée :</label>
    <input type="text" [value]="covoiturage.lieuArrivee" disabled>

    <label>Nombre de places :</label>
    <input type="text" [value]="covoiturage.nbPlace" disabled>

    <label>Prix par personne :</label>
    <input type="text" [value]="covoiturage.prixPersonne + ' €'" disabled>

    <label>Statut :</label>
    <input type="text" [value]="covoiturage.statut || 'N/A'" disabled>

    <div style="display:flex;justify-content:space-between">
      <button type="submit"
              (click)="annulerCovoiturage(covoiturage.id)"
              [disabled]="covoiturage.statut === 'annuler' || covoiturage.statut === 'arriver'"
              style="background-color: #d9534f; margin-top: 0.5rem;">
        Annuler ce covoiturage
      </button>

      <!-- Affiche les boutons si l'utilisateur est le chauffeur -->
      <div *ngIf="isChauffeurMap[covoiturage.id] === true">
        <br />
        <button type="submit"
                *ngIf="covoiturage.statut === 'ouvert'"
                (click)="demarrerCovoiturage(covoiturage.id)"
                class="btn btn-primary">
          Démarrer le voyage
        </button>

        <button type="submit"
                *ngIf="covoiturage.statut === 'en_cours'"
                (click)="arriverCovoiturage(covoiturage.id)"
                class="btn btn-success">
          Arrivée à destination
        </button>
      </div>

      <div *ngIf="isChauffeurMap[covoiturage.id] === false">
        <br />
        <button type="submit"
                *ngIf="covoiturage.statut === 'arriver'"
                [routerLink]="['/saisie_avis', covoiturage.id]"
                class="btn btn-primary">
          Donner un avis
        </button>
      </div>
    </div>

  </div>
</form>

<ng-template #aucunResultat>
  <p style="text-align: center; color: #888; margin-top: 3rem;">
    Aucun covoiturage trouvé pour cet utilisateur.
  </p>
</ng-template>
